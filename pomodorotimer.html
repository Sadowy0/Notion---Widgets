<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomodoro Timer</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; width: 100%; overflow: hidden; background: #191919; color: white; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; display: flex; justify-content: center; align-items: center; text-align: center; }
        #main-scaler { display: flex; flex-direction: column; align-items: center; width: 350px; transition: transform 0.1s ease-out; padding: 10px; }
        .container, .display { display: flex; flex-direction: column; align-items: center; width: 100%; }
        .display { gap: 0; }
        
        /* POWIĘKSZONE STATYSTYKI NA GÓRZE */
        .time-stats { font-size: 16px; font-weight: 700; opacity: 0.5; line-height: 1; order: 1; margin-bottom: -8px; position: relative; z-index: 2; letter-spacing: 0.5px; width: 100%; }
        
        .timer-wrapper { position: relative; display: flex; align-items: center; justify-content: center; min-width: 280px; order: 2; z-index: 1; }
        .timer-display { font-size: 96px; font-weight: 800; line-height: 0.9; letter-spacing: -4px; font-variant-numeric: tabular-nums; transition: opacity 0.3s ease; }
        .status-text { font-size: 14px; font-weight: 800; opacity: 0.8; letter-spacing: 1px; order: 3; margin-top: 4px; line-height: 1; position: relative; z-index: 2; }
        
        .controls { display: flex; gap: 8px; opacity: 0; transition: opacity 0.3s ease; pointer-events: none; position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); z-index: 10; }
        
        @media (min-width: 501px) { .timer-wrapper:hover .timer-display { opacity: 0.05; } .timer-wrapper:hover .controls { opacity: 1; pointer-events: auto; } }
        @media (max-width: 500px) { .timer-wrapper { flex-direction: column; } .controls { position: relative; opacity: 1 !important; pointer-events: auto !important; left: auto; top: auto; transform: none; margin-top: 10px; order: 4; } .timer-display { opacity: 1 !important; font-size: 88px; } }
        
        .btn { border: none; border-radius: 6px; cursor: pointer; background: rgba(255, 255, 255, 0.1); color: #ffffff; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; -webkit-tap-highlight-color: transparent; }
        .btn:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.05); }
        .btn svg { width: 14px; height: 14px; stroke: currentColor; stroke-width: 3; fill: none; pointer-events: none; }
        
        /* ZMNIEJSZONE PRZYCISKI STERUJĄCE */
        .ctrl-btn { width: 30px; height: 30px; }
        
        .settings { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); flex-direction: column; gap: 10px; padding: 15px; background: #1f1f1f; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1); z-index: 2000; width: 220px; }
        .settings.active { display: flex; }
        .settings-row { display: flex; gap: 8px; justify-content: center; }
        .setting-item { display: flex; flex-direction: column; gap: 4px; align-items: center; flex: 1; }
        .setting-label { font-size: 9px; font-weight: 800; opacity: 0.5; text-transform: uppercase; }
        input { background: #2a2a2a; border: 1px solid #3d3d3d; color: white; padding: 4px; border-radius: 4px; width: 100%; text-align: center; font-size: 11px; font-weight: 700; }
        .toggle-btn { width: 36px; height: 20px; background: #444; border-radius: 10px; position: relative; cursor: pointer; border: none; }
        .toggle-btn.active { background: #007AFF; }
        .toggle-btn::before { content: ''; position: absolute; width: 14px; height: 14px; background: white; border-radius: 50%; top: 3px; left: 3px; transition: 0.2s; }
        .toggle-btn.active::before { left: 19px; }
        .settings-actions { display: flex; gap: 6px; margin-top: 5px; }
        .action-btn { flex: 1; height: 32px; font-size: 10px; font-weight: 800; gap: 4px; }
        .btn-save { background: #007AFF; }
        .btn-reset { background: rgba(255, 69, 58, 0.2); color: #ff453a; }
        .btn-reset svg { width: 12px; height: 12px; stroke: #ff453a; }
        .overlay { display: none; position: fixed; top:0; left:0; right:0; bottom:0; z-index:1500; background: rgba(0,0,0,0.7); }
        .overlay.active { display: block; }
    </style>
</head>
<body>
    <div class="overlay" id="overlay"></div>
    <div id="main-scaler">
        <div class="container">
            <div class="display">
                <div class="time-stats"><span id="workMinutesTotal">0</span>m <span id="sessionName">nauki</span> | <span id="breakMinutesTotal">0</span>m pauzy</div>
                <div class="timer-wrapper">
                    <div class="timer-display" id="timerDisplay">25:00</div>
                    <div class="controls">
                        <button class="btn ctrl-btn" id="startBtn"><svg viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button>
                        <button class="btn ctrl-btn" id="stopBtn" style="display: none;"><svg viewBox="0 0 24 24"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg></button>
                        <button class="btn ctrl-btn" id="skipBtn"><svg viewBox="0 0 24 24"><polyline points="5 4 15 12 5 20 5 4"></polyline><line x1="18" y1="5" x2="18" y2="19"></line></svg></button>
                        <button class="btn ctrl-btn" id="settingsBtn"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg></button>
                    </div>
                </div>
                <div class="status-text" id="statusText">NAUKA</div>
            </div>
        </div>
    </div>
    <div class="settings" id="settings">
        <div class="settings-row">
            <div class="setting-item"><label class="setting-label">Praca</label><input type="number" id="workIn" value="25"></div>
            <div class="setting-item"><label class="setting-label">Pauza</label><input type="number" id="breakIn" value="5"></div>
            <div class="setting-item"><label class="setting-label">Długa</label><input type="number" id="longIn" value="15"></div>
            <div class="setting-item"><label class="setting-label">LB</label><button class="toggle-btn active" id="lbToggle"></button></div>
        </div>
        <div class="settings-actions">
            <button class="btn action-btn btn-save" id="saveSettings">ZAPISZ</button>
            <button class="btn action-btn btn-reset" id="resetStats"><svg viewBox="0 0 24 24"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg>RESET</button>
        </div>
    </div>
    <script>
        const e=id=>document.getElementById(id), snd=new Audio('https://cdn.pixabay.com/audio/2022/03/15/audio_7833324f4b.mp3');
        let c=JSON.parse(localStorage.getItem('pomoConfig'))||{work:25,break:5,long:15,name:'nauka',lbEnabled:true},
            s=JSON.parse(localStorage.getItem('pomoStats'))||{workSecs:0,breakSecs:0},
            t=c.work*60, r=false, w=true, sl=4, iv=null, et=null;
        const update=()=>{
            const min=Math.floor(t/60), sec=t%60, str=`${String(min).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
            e('timerDisplay').textContent=str; e('workMinutesTotal').textContent=Math.floor(s.workSecs/60);
            e('breakMinutesTotal').textContent=Math.floor(s.breakSecs/60); e('statusText').textContent=w?c.name.toUpperCase():(sl===0&&c.lbEnabled?"DŁUGA PRZERWA":"PRZERWA");
            document.title=`${str} - ${w?c.name:'Przerwa'}`; fit();
        };
        const fit=()=>{ const sc=Math.min(window.innerWidth/350, window.innerHeight/250, 1); e('main-scaler').style.transform=`scale(${sc})`; };
        const phase=()=>{ if(w){ sl--; t=(c.lbEnabled&&sl<=0)?c.long*60:c.break*60; if(sl<=0)sl=4; } else { if(sl<=0)sl=4; t=c.work*60; } w=!w; snd.play(); };
        const tick=()=>{ if(!r)return; const now=Date.now(), old=t; t=Math.max(0,Math.round((et-now)/1000));
            let d=old-t; if(d>0){ w?s.workSecs+=d:s.breakSecs+=d; localStorage.setItem('pomoStats',JSON.stringify(s)); }
            if(t<=0){ phase(); et=Date.now()+(t*1000); } update();
        };
        const start=()=>{ r=true; et=Date.now()+(t*1000); iv=setInterval(tick,200); e('startBtn').style.display='none'; e('stopBtn').style.display='flex'; };
        const stop=()=>{ r=false; clearInterval(iv); e('startBtn').style.display='flex'; e('stopBtn').style.display='none'; };
        e('startBtn').onclick=start; e('stopBtn').onclick=stop;
        e('skipBtn').onclick=()=>{ const was=r; stop(); phase(); update(); if(was)start(); };
        e('settingsBtn').onclick=()=>{ e('settings').classList.add('active'); e('overlay').classList.add('active'); };
        e('overlay').onclick=()=>{ e('settings').classList.remove('active'); e('overlay').classList.remove('active'); };
        e('lbToggle').onclick=()=>e('lbToggle').classList.toggle('active');
        e('saveSettings').onclick=()=>{
            c.work=parseInt(e('workIn').value)||25; c.break=parseInt(e('breakIn').value)||5; c.long=parseInt(e('longIn').value)||15;
            c.lbEnabled=e('lbToggle').classList.contains('active'); localStorage.setItem('pomoConfig',JSON.stringify(c));
            stop(); t=c.work*60; w=true; sl=4; e('overlay').click(); update();
        };
        e('resetStats').onclick=()=>{ if(confirm("Zresetować statystyki?")){ s={workSecs:0,breakSecs:0}; localStorage.setItem('pomoStats',JSON.stringify(s)); update(); e('overlay').click(); } };
        window.onresize=fit; update();
    </script>
</body>
</html>
